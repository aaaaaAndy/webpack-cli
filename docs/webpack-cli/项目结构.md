```tree
webpack-cli
├── bin
│   └── cli.js ···························· webpack-cli 可执行文件，以命令行运行 webpack-cli 时会进入到这里
├── package.json ·························· npm 配置文件
├── src
│   ├── bootstrap.ts ······················ runCLI 方法，实例化 WebpackCLI，并调用起 run 方法开启 webpack-cli
│   ├── index.ts ·························· 导出 WebpackCLI 类，以 lib 依赖包形式引入 webpack-cli 时会进入到这里
│   ├── plugins
│   │   └── CLIPlugin.ts
│   ├── types.ts ·························· 各种类型声明文件
│   ├── utils
│   │   └── dynamic-import-loader.ts ······ 声明一个动态引入函数，`return import(id)`
│   └── webpack-cli.ts ···················· WebpackCLi 类所在文件，即是 webapck-cli 的核心文件
├── tsconfig.json
└── yarn.lock
```

## 命令行入口
### 1.bin/cli.js
 
 该文件是 webpack 的可执行文件，看其头部的 `#!/usr/bin/env node` 可以知道这是以 node 语言实现命令行可执行文件。 当 webpack以命令行启动时，会进入到这里。

![cli.js](https://raw.githubusercontent.com/aaaaaAndy/picture/main/images/20221027193419.png)

可以看到 `process.env.WEBPACK_CLI_SKIP_IMPORT_LOCAL` 常年为 `undefined`，所以这里会进入到 `if` 语句内部，而 `importLocal()` 内部的核心功能就是 `require()`，传入哪个文件就 require 哪个文件进来，这里意思是优先加载当前项目 node_modules 中的文件。

`runCLI()` 方法是引用了 bootstrap.ts 中的方法。

### 2.src/bootstrap.ts

![bootstrap.ts](https://raw.githubusercontent.com/aaaaaAndy/picture/main/images/20221027194849.png)

该方法代码清晰明了，引入 WebpackCLI 类，实例化这个类，然后调用实例上的 run 方法，这就算是开启了 webpack-cli 核心方法，使得 webpack-cli 开始工作。

## 依赖包入口
### src/index.ts
 
 该文件是当 webpack-cli 以 node 包形式被引入时会进入到这里。

 ![index.ts](https://raw.githubusercontent.com/aaaaaAndy/picture/main/images/20221027194543.png)

index.ts 文件也比较简单，总共有两个导出：
1. 导出 WebpackCLI 类；
2. 导出了 utils 方法，改方法下只挂载了一个 logger 方法集合


